/*
 * Tab Tree
 * http://jomel.me.uk/software/firefox/tabtree/
 * 
 * Copyright (C) 2006 John Mellor (see license.txt)
 */
 
/******* Attributes cross-reference ********
 * Key: PREF means this is directly linked to a particular pref, (PREF[S]) means it is closely linked with a pref [or two]
 * 
 * #content[customtabs]: For one reason or another (e.g. verticaltabbar, colourgroups, coloreachtab, emphasizegroups) we must force -moz-appearance:none
 * #content[colortabs]: (PREFS) - We're going to be applying color to the tabs, rather than keeping them a generic color
 * #content[darktheme]: PREF - The user has told us he is using a dark theme, so try and darken any colors we use (currently only relevant if #content[customtabs] is set)
 * #content[emphasizegroups]: PREF - Make boundaries between groups clearer (a group is a root node and its subtree)
 * tab[level="0"]: The tab is a root node
 * 
 * #content[verticaltabbar]: (PREF) - The tab bar is vertical (either on the left - vertical="left" - or on the right - vertical="right")
 * 
 * #content[showtwistys]: PREF - show twistys on tab[children] whether or not they have tab[children][childrencollapsed]
 * tab[children]: The tab has children (children="visible")
 * tab[children="collapsed"]: The tab's children have been collapsed, so show plus icons on the tabs 
 */

@namespace url("http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul");

/*
 * We need -moz-appearance:none, so set about styling tabs from scratch, taking into account colortabs and emphasizegroups
 */
#content[customtabs] tab {
	-moz-appearance: none !important;
	
	/* Make tabs look decent (xp-style) when -moz-appearance has to be none, but note the lack of !importants */
	color: black;
	background-color: #C7C7C2; /* light gray, but should always be replaced or covered by a background image */
	margin: 2px 0px 1px 1px; /* 1px left margin makes things a little prettier, otherwise enforce the default, especially so when I reduce margin-top to 1px this leaves room for the border */
	padding: 1px 3px 2px; /* enforcing the default (though with slightly less side padding) so it doesn't change for selected tabs */
	border-top: 1px solid;
	border-left: 2px solid;
	border-right: 2px solid;
	border-bottom: none;
	-moz-border-top-colors: #91A7B4 #E3E9EC; /* dark gray/blue, light gray - only the first one should be used here */
	-moz-border-left-colors: #91A7B4 #E3E9EC; /* dark gray/blue, light gray */
	-moz-border-right-colors: #91A7B4 #E3E9EC; /* dark gray/blue, light gray */
	-moz-border-radius: 2px 2px 0 0; /* round the top corners, but prevent rounding the bottom left corner (shame 1.5 doesn't anti-alias these) */
}
#content[customtabs][colortabs="darkenchildren"] tab {
	color: black !important; /* I'm slightly worried this could override userchrome settings to e.g. emphasize unread tabs, but it makes sure we don't get unreadable tabs... */
	background-image: url("chrome://tabtree/skin/gradient.png") !important; /* make sure themes don't hide our background-colors by making this !important */
	/* now set background-color: hsl(0-360, 0/100%, 0-100%) !important; on each tab */
}
#content[customtabs][colortabs="desaturated"] tab {
	color: black !important; /* I'm slightly worried this could override userchrome settings to e.g. emphasize unread tabs, but it makes sure we don't get unreadable tabs... */
	background-image: url("chrome://tabtree/skin/desaturatedgradient.png") !important; /* make sure themes don't hide our background-colors by making this !important */
	/* now set background-color: hsl(0-360, 0/100%, 0-100%) !important; on each tab */
}
/* For the sake of a few themes */
#content[customtabs][colortabs] tab .tab-text {
	color: black !important;
	background: transparent !important;
}
#content[customtabs]:not([colortabs]) tab {
	color: black;
	background: white url("chrome://tabtree/skin/graygradient.png");
}
#content[customtabs]:not([colortabs]) tab[selected="true"] {
	color: black;
	background-color: white;
}
#content[customtabs] tab[selected="true"], #content[customtabs] tab:hover {
	margin-top: 1px; /* to compensate for the extra thickness of the border so the tabbar doesn't change height on hover */
	padding-top: 0; /* to compensate for the extra thickness of the border so the tabbar doesn't change height on hover */
	border-top: 3px solid;
}
#content[customtabs]:not([emphasizegroups]) tab[selected="true"], #content[customtabs]:not([emphasizegroups]) tab:hover {
	-moz-border-top-colors: #E68B2C #FFC83C #FFC73C; /* win-xp default orange */
}
#content[customtabs][emphasizegroups] tab[selected="true"], #content[customtabs][emphasizegroups] tab:hover {
	-moz-border-top-colors: #1D5689 #0C8DFF #0C8DFF; /* blue, since orange is already being used prominently in emphasizegroups */
}
#content[horizontaltabbar][emphasizegroups] tab[selected="true"] {
	/* Make selected tab expand to cover the gaps normally between it and the tabs next to it
	 * this only works if the tab spacing is always 1px, i.e. emphasizegroups is set */
	/*margin-left: -1px;
	margin-right: -2px;
	padding-left: 5px;
	padding-right: 5px;
	position: relative;*/ /* this just makes the selected tab draw on top of its neighbours, as otherwise the top of the right border it missing */
}


/*
 * Adjust colors to fit in with dark themes
 */
#content[darktheme][customtabs] tab {
	color: white;
	background-image: url("chrome://tabtree/skin/darkgradient.png"); /* TODO: tweak this perhaps? - and tabtree_colortabs should perhaps use reverse darknesses */
}
#content[darktheme][customtabs][colortabs] tab {
	color: white !important;
	background-image: url("chrome://tabtree/skin/darkgradient.png") !important;
}
/* For the sake of a few themes */
#content[darktheme][customtabs] tab .tab-text {
	color: white;
}
#content[darktheme][customtabs][colortabs] tab .tab-text {
	color: white !important;
}


/*
 * Separate tab groups
 */
#content[horizontaltabbar]:not([customtabs]) tab {
	-moz-appearance: tab; /* override -moz-appearance:tab-left-edge and -moz-appearance:tab-right-edge */
}
#content[horizontaltabbar]:not([emphasizegroups]) tab[level="0"]:not(:first-child) {
	margin-left: 8px !important;
}
#content[horizontaltabbar][emphasizegroups] tab[level="0"]:not(:first-child) { /* it's debatable whether or not the first tab should have this, depending on whether you regard it as a separator or a property of the tab (group) */
	border-left: 8px solid orange !important;
	/* -moz-border-left-colors: #91A7B4 #E3E9EC orange !important; */
	-moz-border-left-colors: #91A7B4 orange orange orange orange orange orange #91A7B4 !important;
	-moz-border-radius-topleft: 0 !important;
}


/*
 * Show minus/plus icons on tabs with children/childrencollapsed
 */
#content[showtwistys] tab[children] .tab-icon:not([src]), #content tab[children="collapsed"] .tab-icon:not([src]) {
	list-style-image: none !important;
}
#content[showtwistys] tab[children] .tab-text, #content tab[children="collapsed"] .tab-text {
	position: relative !important;
	margin-left: -16px !important;
	padding-left: 16px !important;
	height: 14px !important;
	padding-top: 1px !important;
}
#content[showtwistys] tab[children="visible"] .tab-text {
	background: url("chrome://tabtree/skin/treeminus.png") no-repeat 0 4px !important;
}
#content tab[children="collapsed"] .tab-text {
	background: url("chrome://tabtree/skin/treeplus.png") no-repeat 0 4px !important;
}


/*
 * Adjust CSS for a vertical tab bar (on the left/right)
 * (sure the !important's will override a lot of themes, but there's too high a chance they'd mess things up otherwise)
 */
#content[verticaltabbar] .tabbrowser-tabs {
	padding-left: 0 !important; /* you want to remove this regardless of the direction of .tabbrowser-tabs */
	border-bottom: none !important;
}
#content[verticaltabbar="left"] .tabbrowser-tabs {
	border-right: 1px solid #AAAAAA !important;
}
#content[verticaltabbar="right"] .tabbrowser-tabs {
	border-left: 1px solid #AAAAAA !important;
}
#content[verticaltabbar] tab {
	-moz-appearance: none !important;
	margin: 0 !important;
	padding: 1px 4px 2px !important; /* enforcing the default so it doesn't change on hover/select */
	border: none !important;
}
#content[verticaltabbar] tab[selected="true"] {
	padding: 0px 4px 1px !important; /* Make room for the top and bottom borders */
	border-top: 1px solid #91A7B4 !important;
	border-bottom: 1px solid #91A7B4 !important;
	-moz-border-radius: 0 !important;
	-moz-border-top-colors: #91A7B4 !important;
	-moz-border-bottom-colors: #91A7B4 !important;
}
#content[verticaltabbar] .tab-drop-indicator-bar {
	/* TODO: fix vertical tab dragging, hopefully so this still works */
	display: none !important;
}
